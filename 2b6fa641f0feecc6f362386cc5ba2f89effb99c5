- added ipv6 patch
- partially rewrited
